---
title: "Homework07"
author: "Alyssa Neuhaus"
date: "2/26/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

# If hypothesis were true, there would be a statistically significant relationship between the blood Hg levels and the infection status. Individuals with high blood Hg levels would be more likely to be infected, while individuals with low blood Hg levels are more likely to not be infected.

# Using logistic regression because y variable (infection status) is categorical, and x variable (blood Hg level) is continuous.

```{r}
Blood_Hg_Level <- sort(rnorm(n=1000,mean=0.7,sd=0.2)) 
head(Blood_Hg_Level)
Infection_Status <- sample(rep(c(0,1),each=100),prob=seq_len(200))
head(Infection_Status)
l_reg_data <- data.frame(Blood_Hg_Level,Infection_Status)
head(l_reg_data)
```

```{r}
l_reg_model <- glm(Infection_Status~Blood_Hg_Level,
                   data=l_reg_data,
                   family=binomial(link=logit))
summary(l_reg_model)
summary(l_reg_model)$coefficients
```

```{r}
library(ggplot2)
lreg_plot <- ggplot(data=l_reg_data,
                    aes(x=Blood_Hg_Level,y=Infection_Status)) +
                    geom_point() +
                    stat_smooth(method=glm,
                                method.args=list(family=binomial))
print(lreg_plot)
```
# This logistic regression yields a statistically significant difference

# Begin adjusting the means of the different groups. Given the sample sizes you have chosen, how small can the differences between the groups be for you to still detect a significant pattern?

```{r}
Blood_Hg_Level <- sort(rnorm(n=60,mean=0.7,sd=0.02)) 
head(Blood_Hg_Level)
Infection_Status <- sample(rep(c(1,0),each=60),prob=seq_len(120))
head(Infection_Status)
as.factor(Infection_Status)
l_reg_data <- data.frame(Blood_Hg_Level,Infection_Status)
head(l_reg_data)
```


```{r}
l_reg_model <- glm(Infection_Status~Blood_Hg_Level,
                   data=l_reg_data,
                   family=binomial(link=logit))
summary(l_reg_model)
summary(l_reg_model)$coefficients

library(ggplot2)
lreg_plot <- ggplot(data=l_reg_data,
                    aes(x=Blood_Hg_Level,y=Infection_Status)) +
                    geom_point() +
                    stat_smooth(method=glm,
                                method.args=list(family=binomial))
print(lreg_plot)
```
# when sample size is 10, log reg line is basically horizontal and p value is not significant. When sample size is 60, the p-value for the independent variable is less than 0.05. Changing the mean of the x-value does not seem to have a consistent effect on the p-value. When the y value is sampled from 1,0 instead of 0,1 the infected individuals (1) have a higher blood Hg level than uninfected individuals (0). This is because 1 is weighted more as the number of samples increases. 

